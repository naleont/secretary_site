{% extends 'base.html' %}

{% block content %}

<h1>Мои волонтерские задачи</h1>


{% if involved == '1553' %}
<p>Я учусь в Школе им. В. И. Вернадского. <a href="/edit_profile/{{ session['user_id'] }}">Исправить</a></p>
<form action="/set_class" method="post">
    <fieldset>
        <span>Класс </span>
        <select name="class_id">
            {% for cl in sch_class %}
                <option value="{{ cl['class_id'] }}" {% if class_id == cl['class_id'] %} selected="true"
            {% endif %}>{{ cl['class_name'] }}</option>
            {% endfor %}
        </select>
        <input class="button" type="submit" value="Сохранить"><br><br>
    </fieldset>
</form>
{% elif involved == 'MSU_School' %}
<p>Я учусь в Университетской гимназии МГУ. <a href="/edit_profile/{{ session['user_id'] }}">Исправить</a></p>
<form action="/set_class" method="post">
    <fieldset>
        <span>Класс </span>
        <select name="class_id">
            {% for cl in sch_class %}
                <option value="{{ cl['class_id'] }}" {% if class_id == cl['class_id'] %} selected="true"
            {% endif %}>{{ cl['class_name'] }}</option>
            {% endfor %}
        </select>
        <input class="button" type="submit" value="Сохранить"><br><br>
    </fieldset>
</form>
{% endif %}

<form action="/choose_volunteer_tasks" method="post">
    <fieldset>

    </fieldset>
</form>

<table frame="void" border="2px" bordercolor="#4962A4">
    <tr>
        <td align="center"><b>
            Дата
        </b></td>
        <td align="center"><b>
            Время
        </b></td>
        <td align="center"><b>
            Локация
        </b></td>
        <td align="center"><b>
            Задача
        </b></td>
        <td align="center"><b>
            Описание
        </b></td>
        <td align="center"><b>
            Выбрать
        </b></td>
        <td align="center"><b>
            Нужно волонтеров
        </b></td>
        <td align="center"><b>
            Заявка
        </b></td>
    </tr>
    {% for day in tasks.values() %}
    <tr>
        <td rowspan="{{ day|length }}">
            {{ day[0]['task_date'] }}
        </td>
        {% for task in day %}
        <td align="center">
            {{ task['start_time'] }} – {{ task['end_time'] }}
        </td>
        <td align="center">
            {{ task['location'] }}<br>
            <span class="comment"><i>{{ task['address'] }}</i></span>
        </td>
        <td>
            {{ task['task_name'] }}
        </td>
        <td>
            {{ task['description'] }}
        </td>
        <td align="center">
            {% if task['applied'] == True %}
            <a href="/pick_task/{{ task['id'] }}/delete" class="green-text">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-check2-square" viewBox="0 0 16 16">
                  <path d="M3 14.5A1.5 1.5 0 0 1 1.5 13V3A1.5 1.5 0 0 1 3 1.5h8a.5.5 0 0 1 0 1H3a.5.5 0 0 0-.5.5v10a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5V8a.5.5 0 0 1 1 0v5a1.5 1.5 0 0 1-1.5 1.5z"/>
                  <path d="m8.354 10.354 7-7a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0"/>
                </svg>
            </a>
            {% elif task['applied'] == False %}
            <a href="/pick_task/{{ task['id'] }}/pick" class="alarm">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-square" viewBox="0 0 16 16">
                  <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"/>
                </svg>
            </a>
            {% endif %}
        </td>
        <td align="center">
            {{ task['volunteers_required'] }}
        </td>
        <td>
            {% if task['applied'] == False %}
            Не подана
            {% else %}
            {% if task['permitted'] == True %}
            Одобрена
            {% elif task['permitted'] == None %}
            Подана
            {% elif task['permitted'] == False %}
            Отклонена
            {% endif %}
            {% endif %}
        </td>
    </tr>
    <tr>
        {% endfor %}
    </tr>
    {% endfor %}
</table>

{% endblock %}
